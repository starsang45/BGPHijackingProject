
Network Project - BGPHijacking 
1
<p>&nbsp;Scenario</p><p>In this project, which is based on the BGP Path Hijacking Attack Demo included in the Mininet project, we will explore some of the vulnerabilities of Border Gateway Protocol (BGP). In particular, we will see how BGP is vulnerable to abuse and manipulation through a class of attacks called BGP hijacking attacks. A malicious AS can mount these attacks through false BGP announcements from a rogue AS, causing victim ASes to route their traffic bound for another AS through the malicious AS. This attack succeeds because the false advertisement exploits BGP routing behavior by advertising a shorter path to reach a particular prefix, which causes victim ASes to attempt to use the newly advertised (and seemingly better!) route.</p><p></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEiu684U54BlXA73td5f11J31LDa8e6qcyQ3wbdAD24gnNxjX-L6s7676oTdwoa4AeNZFO3tRk8F7UR3VtjncGN81lxJqmpktcTw8XXc85y-F1NYMvH-gBx7f46rHkUcP1h1I2xQUQhUsXG41oczkNnUX9SBbtt5HP3ygKHwpLgK6HIeULEEwpgXI-hLUjA" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img alt="" data-original-height="465" data-original-width="733" height="406" src="https://blogger.googleusercontent.com/img/a/AVvXsEiu684U54BlXA73td5f11J31LDa8e6qcyQ3wbdAD24gnNxjX-L6s7676oTdwoa4AeNZFO3tRk8F7UR3VtjncGN81lxJqmpktcTw8XXc85y-F1NYMvH-gBx7f46rHkUcP1h1I2xQUQhUsXG41oczkNnUX9SBbtt5HP3ygKHwpLgK6HIeULEEwpgXI-hLUjA=w640-h406" width="640" /></a></div><br /><br /><p></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p>STEPS TO START DEMO</p><p>As part of completing this project,</p><p>1. Download and unzip the project files. This should create a directory named BGPHijacking (the “Project Directory”). The file permissions and ownership should be correct, but if not, adjust them appropriately. It’s okay to freely discuss this aspect of the project on Edstem.</p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiNsr1xYXRLU06MaxJvItdpWIKmyUtn-1J9VewHND8oV01ZdDGZ7gMN-Rn5j5I7ZgUsruc9oDzBYHwQnk99T0Uhka1T-L3NAbw-qQ2chRhUpPXJgD1r394B7TYCqBBmBg4yOpmk_BQsa7K_GKuP5xzE2VHc0_lAMN8qJEDfiaEfSksdm1DXjZnDUDXInFU/s893/Screenshot%202024-11-03%20104142.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="664" data-original-width="893" height="475" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiNsr1xYXRLU06MaxJvItdpWIKmyUtn-1J9VewHND8oV01ZdDGZ7gMN-Rn5j5I7ZgUsruc9oDzBYHwQnk99T0Uhka1T-L3NAbw-qQ2chRhUpPXJgD1r394B7TYCqBBmBg4yOpmk_BQsa7K_GKuP5xzE2VHc0_lAMN8qJEDfiaEfSksdm1DXjZnDUDXInFU/w640-h475/Screenshot%202024-11-03%20104142.png" width="640" /></a></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><br /><p><br /></p><p>2. For some of the steps below, you will use the sudo command. You might be asked to enter your password. If sudo asks you to enter a password, use “mininet.”</p><p>3. Open a terminal in the Project Directory. Type: sudo python ./bgp.py. After loading the topology, the Mininet CLI should be visible. Keep this terminal open throughout the experiment.</p><p>4. Open a second terminal in the Project directory. You will use this terminal to access R1’s routing daemon (bgpd). Do that by executing the following command: ./connect.sh</p><p>5. The connect.sh script uses run.py to connect to the bgpd shell on the router specified in the variable $router. Accessing the bgpd shell will start quagga, which will ask for a password. The password is: “en”. Once you have authenticated, you will have access to the administration shell and R1 routing table. When you get the bgpd-R1# prompt, type the following command: sh ip bgp</p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEirvDz7ZvnNhzZq2q6YPVsq8vf6DVuQRdpaw5ZiGDhD8LtxLHJlmN2mxtR_p2E1xrhK9GXSt4aAVt49hpQr6BC6E_MjfFEgivXPMVO2DWnprNxHbSq4o8h05V3md5biiOs6vU71Uc_YMxbweUGXFINdQPHXKmZMlCUNWMtJx_E6O0lE2ofuhVmWMKkMOYY/s831/Screenshot%202024-11-03%20150408.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="287" data-original-width="831" height="222" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEirvDz7ZvnNhzZq2q6YPVsq8vf6DVuQRdpaw5ZiGDhD8LtxLHJlmN2mxtR_p2E1xrhK9GXSt4aAVt49hpQr6BC6E_MjfFEgivXPMVO2DWnprNxHbSq4o8h05V3md5biiOs6vU71Uc_YMxbweUGXFINdQPHXKmZMlCUNWMtJx_E6O0lE2ofuhVmWMKkMOYY/w640-h222/Screenshot%202024-11-03%20150408.png" width="640" /></a></div><br /><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p>6. You should see output very much like the screen grab below. Notice that AS1 has chosen the path via AS2 and AS3 to reach the prefix 13.0.0.0/8. NOTE: It may take a minute for the routes to settle. Try the command until you see all three routes.</p><p>7. Next, verify that network traffic is traversing this path. Open a third terminal in the Project Directory (keeping all other terminals open). In this terminal, you will start a script that continuously makes web requests from a host within AS1 to a web server in AS3. Type in the following: ./website.sh</p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhwrWJ_me3C4HYPPsvXnBh6qy1etGnoxFyWsiZCeL3uooB49LYUgCoy_i-selHv6yExUtb_vrwG7tx3peYPY0zpo_xAsy6Vm6hmg3HPJ96tN2LbqlBTDEQLQayHhU9eLqg0-hZ44WNLVZr-7T-9AOhe2MZ05i_6YX6o4dXAc5FUoxn7SvkazFeLriXDtdE/s741/Screenshot%202024-11-03%20151336.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="192" data-original-width="741" height="166" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhwrWJ_me3C4HYPPsvXnBh6qy1etGnoxFyWsiZCeL3uooB49LYUgCoy_i-selHv6yExUtb_vrwG7tx3peYPY0zpo_xAsy6Vm6hmg3HPJ96tN2LbqlBTDEQLQayHhU9eLqg0-hZ44WNLVZr-7T-9AOhe2MZ05i_6YX6o4dXAc5FUoxn7SvkazFeLriXDtdE/w640-h166/Screenshot%202024-11-03%20151336.png" width="640" /></a></div><br /><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p>8. Now, you will start a rogue AS (AS4) that will connect directly to AS1 and advertise the same 13.0.0.0/8 prefix. This will allow AS4 to hijack the prefix due to the shorter AS Path</p><p>7. Open a third terminal in the Project Directory (keeping all other terminals open) and type the following: ./start_rogue.sh</p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3OMk3ifDE9iNfkLra6MATM_2zO-9Q-Na-YBoMy1vrI8PSmDAniXGwIwyrhalPvunLEI-f_sJtL7v1SAi7EspiMaYuqk05dtWwRLStuBBsWnm0zU4grlS24jUa_GZG7hFIOjdBivI5_52Za-CohBFs840sKjp5IvAb_dgNFGcVW3-thKOxFz57XsbTJxU/s831/Screenshot%202024-11-03%20152221.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="126" data-original-width="831" height="98" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3OMk3ifDE9iNfkLra6MATM_2zO-9Q-Na-YBoMy1vrI8PSmDAniXGwIwyrhalPvunLEI-f_sJtL7v1SAi7EspiMaYuqk05dtWwRLStuBBsWnm0zU4grlS24jUa_GZG7hFIOjdBivI5_52Za-CohBFs840sKjp5IvAb_dgNFGcVW3-thKOxFz57XsbTJxU/w640-h98/Screenshot%202024-11-03%20152221.png" width="640" /></a></div><br /><p><br /></p><p><br /></p><p><br /></p><p>9. Return to the third terminal window and observe the continuous web requests. After the BGP routing tables converge on this simple network, you will see the attacker start responding to requests from AS1, rather than AS3.</p><p></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjTAs2wJhckl9bZYOs-0DLGChkFuvTkicerI_xojZxZrdoTIkXnnX3oAWvVibQTOylIQ5iiU8yFoZH0Ti-hjrXp8gLCtzO6xEK6Y4Tla39fhgZNTYfjO5jRMX9JXV1ajctgeMTNcVd2tlg-mOtiKkOtYFFteAzL-UO9c5o4gPz0YoxfmC2i2jNC0-NOtzM/s823/Screenshot%202024-11-03%20152231.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="84" data-original-width="823" height="66" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjTAs2wJhckl9bZYOs-0DLGChkFuvTkicerI_xojZxZrdoTIkXnnX3oAWvVibQTOylIQ5iiU8yFoZH0Ti-hjrXp8gLCtzO6xEK6Y4Tla39fhgZNTYfjO5jRMX9JXV1ajctgeMTNcVd2tlg-mOtiKkOtYFFteAzL-UO9c5o4gPz0YoxfmC2i2jNC0-NOtzM/w640-h66/Screenshot%202024-11-03%20152231.png" width="640" /></a></div>10. You should also return to the second terminal and rerun the command to print the routing table. You should now see the fraudulent advertisement for the 13.0.0.0/8 prefix in the routing table, in addition to the longer unused path to the legitimate owner of the route.<p></p><p>11. Finally, stop the attack by switching to the fourth terminal and typing: ./stop_rogue.sh</p><p>12. You should notice a fast reconvergence to the original legitimate route in the third terminal window, which should now be delivering the original traffic. Additionally, you can check the BGP routing table again to see that the original path is being traversed.</p><p><br /></p><p><b>BGP Hijacking Attack</b></p><p>This is the graded part of the project.</p><p>Part 1: Simple BGP Hijacking on a customized topology</p><p>Your task is to replicate a different topology and attack scenario to demonstrate the effects of a Prefix Hijack Attack. Your goal is to impersonate true origin AS1 using the false origin AS6.</p><p>IMPORTANT NOTE: It’s recommended to build your attack scenario off the demo files. Make a backup of your demo files so you can refer to them as you modify the files.</p><p>STEPS FOR YOUR ATTACK SCENARIO</p><p><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left;"><tbody><tr><td style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhj4bgXDjge8A8r0MASi-GcwjpTtsmH3FLVqqtEAJEM7glJ4L2J03uXpWYubqz22wdZM6u7LbH1ic0Yz4LbY-FBz7yamepuqZhJP1UMt34VyIUYcZKXhU3gikWBmscruuQSAxMd_nx15WIpWMyd0gKphoSKiJl05vIZs2zVPzHKPRMqgpBTY5VsYnMPVgU" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img alt="" data-original-height="399" data-original-width="370" height="400" src="https://blogger.googleusercontent.com/img/a/AVvXsEhj4bgXDjge8A8r0MASi-GcwjpTtsmH3FLVqqtEAJEM7glJ4L2J03uXpWYubqz22wdZM6u7LbH1ic0Yz4LbY-FBz7yamepuqZhJP1UMt34VyIUYcZKXhU3gikWBmscruuQSAxMd_nx15WIpWMyd0gKphoSKiJl05vIZs2zVPzHKPRMqgpBTY5VsYnMPVgU=w372-h400" width="372" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Topology for Hijacking scenario<br /><br /><br /><br /><br /><br /><br /></td></tr></tbody></table><br /><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p>First, according to the topology above taken from Figure 2 in the referenced paper. Draw a topology map using any drawing tool of your choice. See Slide 7 of the presentation slides for an example of the level of detail desired in your topology diagram.</p><p>You may hand-draw your topology with pencil and paper and scan or photograph your drawing. All configuration values drawn on the map must be legible! Save your topology diagram in PDF format with the name fig2_topo.pdf. You must use this filename as part of your submission to receive credit for your diagram. We find that if you do your diagram first, the following steps will be much easier!</p><p>2. We recommend making a copy of the code provided to you in the Project files (the full demo folder). This will make it easier to complete this project, and you will likely find it more approachable if you spend time exploring the demo code and fully understanding how each part works rather than immediately trying to edit the code.</p><p>3. Next, refer to the topology above or in the paper, and create/edit the necessary files to reconstruct the topology. (TIPS: BGP message won’t be propagated before establishing connectivity between nodes)</p><p>Please figure out all the config files and python/shell scripts to edit to carry out the attack on the topology. After modifying all the necessary files, you should be able to use the commands from the demo to recreate the attack on the new topology you built in the Project Directory. You can assume the following:</p><p>• All links are bidirectional peering links.</p><p>• Each AS advertises a single prefix: AS1: 11.0.0.0/8, AS2: 12.0.0.0/8, AS3: 13.0.0.0/8, AS4: 14.0.0.0/8, AS5: 15.0.0.0/8, AS6: 11.0.0.0/8</p><p>• The number of hosts in each AS is the same as in the provided code (the demo).</p><p>• You don’t need to modify the helper scripts (run.py, webserver.py, connect.sh), and you should read through all the shell scripts.</p><p>4. Do not change passwords in zebra and conf files. If you change the passwords, the auto-grader will fail, resulting in 0 for the assignment. All passwords need to follow the demo and be ‘en’</p><p>5. Do not change the names of the config files, follow the pattern when creating new config files.</p><p>6. When complete, you should be able to use the commands from the demo to start a Rogue AS and demonstrate a similar change in routing table information as was shown in the demo and see the screen printout (website.sh) as in the demo. Your goal is to impersonate true origin AS1 using the false origin AS6. The attack should be observed on hosts connected to AS5.</p>
글 설정
라벨
일치하는 추천 없음
게시 날짜
24. 11. 3. 오전 10:35
퍼머링크
위치
옵션
글: 수정
